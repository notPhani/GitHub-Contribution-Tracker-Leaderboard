<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Profile Viewer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            overflow-x: hidden;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
        }

        .profile-card {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            height: fit-content;
        }

        .avatar {
            width: 100px;
            height: 100px;
            background: #0969da;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            font-weight: bold;
            margin: 0 auto 20px;
            overflow: hidden;
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .name {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .username {
            text-align: center;
            color: #666;
            margin-bottom: 15px;
        }

        .bio {
            text-align: center;
            line-height: 1.6;
            color: #333;
            margin-bottom: 20px;
            word-wrap: break-word;
        }

        .no-bio {
            font-style: italic;
            color: #999;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            padding: 20px 0;
            border-top: 1px solid #e5e5e5;
            border-bottom: 1px solid #e5e5e5;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            display: block;
            font-size: 24px;
            font-weight: bold;
            color: #0969da;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
        }

        .info-section {
            margin: 20px 0;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 0;
            color: #555;
            font-size: 14px;
            word-wrap: break-word;
        }

        .info-icon {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
        }

        .github-link-btn {
            width: 100%;
            padding: 12px;
            background: #24292e;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
            text-decoration: none;
            display: block;
            text-align: center;
        }

        .github-link-btn:hover {
            background: #1a1e22;
        }

        .main-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
            min-width: 0;
        }

        .section {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .section-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .repo-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #0969da;
            transition: transform 0.2s;
        }

        .repo-card:hover {
            transform: translateX(5px);
        }

        .repo-name {
            font-size: 18px;
            font-weight: bold;
            color: #0969da;
            margin-bottom: 10px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            word-wrap: break-word;
        }

        .repo-name:hover {
            text-decoration: underline;
        }

        .repo-description {
            color: #555;
            line-height: 1.5;
            margin-bottom: 10px;
            word-wrap: break-word;
        }

        .repo-stats {
            display: flex;
            gap: 20px;
            font-size: 14px;
            color: #666;
            flex-wrap: wrap;
        }

        .repo-language {
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .language-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #0969da;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: #999;
            font-style: italic;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #0969da;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .contribution-section {
            overflow-x: auto;
            padding: 10px 0;
        }

        .contribution-graph {
            display: inline-grid;
            grid-template-rows: repeat(7, 12px);
            grid-auto-flow: column;
            gap: 3px;
            margin: 20px 0;
        }

        .contribution-day {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            background: #ebedf0;
            cursor: pointer;
            transition: all 0.2s;
        }

        .contribution-day:hover {
            transform: scale(1.2);
            border: 1px solid #1a7f37;
        }

        .contribution-day[data-level="0"] { background: #ebedf0; }
        .contribution-day[data-level="1"] { background: #9be9a8; }
        .contribution-day[data-level="2"] { background: #40c463; }
        .contribution-day[data-level="3"] { background: #30a14e; }
        .contribution-day[data-level="4"] { background: #216e39; }

        .graph-legend {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #666;
            margin-top: 15px;
        }

        .legend-samples {
            display: flex;
            gap: 3px;
        }

        .contribution-stats {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .contribution-stat {
            font-size: 14px;
            color: #666;
        }

        .contribution-stat strong {
            color: #0969da;
            font-size: 16px;
        }

        .month-labels {
            display: inline-grid;
            grid-auto-flow: column;
            gap: 3px;
            margin-bottom: 5px;
            font-size: 11px;
            color: #666;
        }

        .month-label {
            width: 52px;
            text-align: left;
        }

        .day-labels {
            display: grid;
            grid-template-rows: repeat(7, 12px);
            gap: 3px;
            margin-right: 8px;
            font-size: 10px;
            color: #666;
            text-align: right;
        }

        .day-label {
            line-height: 12px;
        }

        .graph-container {
            display: flex;
            align-items: flex-start;
        }

        .loading-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            gap: 20px;
        }

        .loading-text {
            font-size: 18px;
            color: #666;
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                padding: 10px;
            }

            .section {
                padding: 20px;
            }

            .month-labels {
                font-size: 9px;
            }

            .day-labels {
                font-size: 9px;
            }
        }
    </style>
</head>
<body>
    <div class="loading-screen" id="loadingScreen">
        <div class="spinner"></div>
        <div class="loading-text">Loading profile...</div>
    </div>

    <div class="container" id="mainContainer" style="display: none;">
        <aside>
            <div class="profile-card">
                <div class="avatar" id="avatar"></div>
                
                <div class="name" id="displayName"></div>
                <div class="username" id="displayUsername"></div>
                
                <div class="bio" id="displayBio"></div>
                
                <div class="stats">
                    <div class="stat-item">
                        <span class="stat-number" id="repoCount">0</span>
                        <span class="stat-label">Repos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="followerCount">0</span>
                        <span class="stat-label">Followers</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="followingCount">0</span>
                        <span class="stat-label">Following</span>
                    </div>
                </div>
                
                <div class="info-section" id="infoSection"></div>
                
                <a href="#" class="github-link-btn" id="githubLink" target="_blank">
                    View on GitHub
                </a>
            </div>
        </aside>

        <main class="main-content">
            <section class="section">
                <h2 class="section-title">üìä Contribution Activity</h2>
                <div class="contribution-stats" id="contributionStats">
                    <div class="contribution-stat">
                        <strong id="totalContributions">0</strong> contributions in the last year
                    </div>
                </div>
                <div class="contribution-section">
                    <div class="month-labels" id="monthLabels"></div>
                    <div class="graph-container">
                        <div class="day-labels">
                            <div class="day-label"></div>
                            <div class="day-label">Mon</div>
                            <div class="day-label"></div>
                            <div class="day-label">Wed</div>
                            <div class="day-label"></div>
                            <div class="day-label">Fri</div>
                            <div class="day-label"></div>
                        </div>
                        <div class="contribution-graph" id="contributionGraph"></div>
                    </div>
                    <div class="graph-legend">
                        <span>Less</span>
                        <div class="legend-samples">
                            <div class="contribution-day" data-level="0"></div>
                            <div class="contribution-day" data-level="1"></div>
                            <div class="contribution-day" data-level="2"></div>
                            <div class="contribution-day" data-level="3"></div>
                            <div class="contribution-day" data-level="4"></div>
                        </div>
                        <span>More</span>
                    </div>
                </div>
            </section>

            <section class="section">
                <h2 class="section-title">üìö Public Repositories</h2>
                <div id="reposList"></div>
            </section>
        </main>
    </div>

    <script>
        window.addEventListener('DOMContentLoaded', function() {
            const userData = localStorage.getItem('githubTrackerUser');
            
            if (!userData) {
                window.location.href = 'home.html';
                return;
            }

            const user = JSON.parse(userData);
            loadProfile(user.github);
        });

        async function loadProfile(username) {
            try {
                const userResponse = await fetch(`https://api.github.com/users/${username}`);
                
                if (!userResponse.ok) {
                    alert('Failed to load profile. Please try logging in again.');
                    window.location.href = 'home.html';
                    return;
                }

                const userData = await userResponse.json();

                const reposResponse = await fetch(`https://api.github.com/users/${username}/repos?sort=updated&per_page=10`);
                const reposData = await reposResponse.json();

                const eventsResponse = await fetch(`https://api.github.com/users/${username}/events/public?per_page=100`);
                const eventsData = await eventsResponse.json();

                displayProfile(userData, reposData);
                generateContributionGraph(eventsData);
                
                document.getElementById('loadingScreen').style.display = 'none';
                document.getElementById('mainContainer').style.display = 'grid';

            } catch (error) {
                alert('Error loading profile: ' + error.message);
                window.location.href = 'home.html';
            }
        }

        function generateContributionGraph(events) {
            const graph = document.getElementById('contributionGraph');
            const monthLabelsContainer = document.getElementById('monthLabels');
            graph.innerHTML = '';
            monthLabelsContainer.innerHTML = '';
            
            const contributionMap = {};
            let totalContributions = 0;
            
            events.forEach(event => {
                const date = new Date(event.created_at).toDateString();
                contributionMap[date] = (contributionMap[date] || 0) + 1;
                totalContributions++;
            });

            const today = new Date();
            const oneYearAgo = new Date(today);
            oneYearAgo.setDate(today.getDate() - 364);
            
            const startDate = new Date(oneYearAgo);
            const dayOfWeek = startDate.getDay();
            startDate.setDate(startDate.getDate() - dayOfWeek);

            const weeks = 52;
            
            let currentMonth = -1;
            for (let week = 0; week < weeks; week++) {
                const date = new Date(startDate);
                date.setDate(date.getDate() + (week * 7));
                const month = date.getMonth();
                
                if (month !== currentMonth) {
                    currentMonth = month;
                    const monthLabel = document.createElement('div');
                    monthLabel.className = 'month-label';
                    monthLabel.textContent = date.toLocaleDateString('en-US', { month: 'short' });
                    monthLabelsContainer.appendChild(monthLabel);
                } else {
                    const emptyLabel = document.createElement('div');
                    emptyLabel.className = 'month-label';
                    monthLabelsContainer.appendChild(emptyLabel);
                }
            }

            for (let week = 0; week < weeks; week++) {
                for (let day = 0; day < 7; day++) {
                    const date = new Date(startDate);
                    date.setDate(date.getDate() + (week * 7) + day);
                    
                    if (date > today) continue;

                    const dayElement = document.createElement('div');
                    dayElement.className = 'contribution-day';
                    
                    const dateString = date.toDateString();
                    const count = contributionMap[dateString] || 0;
                    
                    let level = 0;
                    if (count > 0) {
                        if (count >= 10) level = 4;
                        else if (count >= 7) level = 3;
                        else if (count >= 4) level = 2;
                        else level = 1;
                    }
                    
                    dayElement.setAttribute('data-level', level);
                    dayElement.title = `${count} contribution${count !== 1 ? 's' : ''} on ${date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}`;
                    
                    graph.appendChild(dayElement);
                }
            }

            document.getElementById('totalContributions').textContent = totalContributions;
        }

        function displayProfile(userData, reposData) {
            const avatarDiv = document.getElementById('avatar');
            if (userData.avatar_url) {
                avatarDiv.innerHTML = `<img src="${userData.avatar_url}" alt="${userData.login}">`;
            } else {
                avatarDiv.textContent = userData.login.substring(0, 2).toUpperCase();
            }

            document.getElementById('displayName').textContent = userData.name || userData.login;
            document.getElementById('displayUsername').textContent = `@${userData.login}`;

            const bioDiv = document.getElementById('displayBio');
            if (userData.bio) {
                bioDiv.innerHTML = userData.bio;
                bioDiv.classList.remove('no-bio');
            } else {
                bioDiv.innerHTML = 'No bio available';
                bioDiv.classList.add('no-bio');
            }

            document.getElementById('repoCount').textContent = userData.public_repos;
            document.getElementById('followerCount').textContent = userData.followers;
            document.getElementById('followingCount').textContent = userData.following;

            const infoSection = document.getElementById('infoSection');
            let infoHTML = '';

            if (userData.company) {
                infoHTML += `
                    <div class="info-item">
                        <svg class="info-icon" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M1.75 16A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0h8.5C11.216 0 12 .784 12 1.75v12.5c0 .085-.006.168-.018.25h2.268a.25.25 0 0 0 .25-.25V8.285a.25.25 0 0 0-.111-.208l-1.055-.703a.749.749 0 1 1 .832-1.248l1.055.703c.487.325.779.871.779 1.456v5.965A1.75 1.75 0 0 1 14.25 16h-3.5a.766.766 0 0 1-.197-.026c-.099.017-.2.026-.303.026h-3a.75.75 0 0 1-.75-.75V14h-1v1.25a.75.75 0 0 1-.75.75Zm-.25-1.75c0 .138.112.25.25.25H4v-1.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 .75.75v1.25h2.25a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25ZM3.75 6h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5ZM3 3.75A.75.75 0 0 1 3.75 3h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 3 3.75Zm4 3A.75.75 0 0 1 7.75 6h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 7 6.75ZM7.75 3h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5ZM3 9.75A.75.75 0 0 1 3.75 9h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 3 9.75ZM7.75 9h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5Z"></path>
                        </svg>
                        <span>${userData.company}</span>
                    </div>
                `;
            }

            if (userData.location) {
                infoHTML += `
                    <div class="info-item">
                        <svg class="info-icon" viewBox="0 0 16 16" fill="currentColor">
                            <path d="m12.166 8.94-.93 1.64a.749.749 0 0 1-1.03.25l-2.87-1.65-2.87 1.65a.748.748 0 0 1-1.03-.25l-.93-1.64-.93-1.64a.75.75 0 0 1 .7-1.05h1.76V3.5a2 2 0 0 1 2-2h2.5a2 2 0 0 1 2 2v2.74h1.76a.75.75 0 0 1 .7 1.05l-.93 1.65Z"></path>
                        </svg>
                        <span>${userData.location}</span>
                    </div>
                `;
            }

            if (userData.blog) {
                infoHTML += `
                    <div class="info-item">
                        <svg class="info-icon" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M7.775 3.275a.75.75 0 0 0 1.06 1.06l1.25-1.25a2 2 0 1 1 2.83 2.83l-2.5 2.5a2 2 0 0 1-2.83 0 .75.75 0 0 0-1.06 1.06 3.5 3.5 0 0 0 4.95 0l2.5-2.5a3.5 3.5 0 0 0-4.95-4.95l-1.25 1.25Zm-4.69 9.64a2 2 0 0 1 0-2.83l2.5-2.5a2 2 0 0 1 2.83 0 .75.75 0 0 0 1.06-1.06 3.5 3.5 0 0 0-4.95 0l-2.5 2.5a3.5 3.5 0 0 0 4.95 4.95l1.25-1.25a.75.75 0 0 0-1.06-1.06l-1.25 1.25a2 2 0 0 1-2.83 0Z"></path>
                        </svg>
                        <a href="${userData.blog}" target="_blank" style="color: #0969da; text-decoration: none; word-break: break-all;">${userData.blog}</a>
                    </div>
                `;
            }

            if (userData.twitter_username) {
                infoHTML += `
                    <div class="info-item">
                        <svg class="info-icon" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M13.3174 3.35817C12.8184 3.57817 12.2784 3.72517 11.7124 3.78517C12.2904 3.43217 12.7404 2.87117 12.9534 2.20217C12.4134 2.52817 11.8154 2.76017 11.1774 2.89017C10.6724 2.33217 9.9494 2 9.1574 2C7.6154 2 6.3674 3.24817 6.3674 4.79017C6.3674 5.00617 6.3914 5.21617 6.4384 5.41617C4.1594 5.29617 2.1364 4.18417 0.8164 2.52017C0.5764 2.93617 0.4364 3.43017 0.4364 3.96017C0.4364 4.96017 0.9424 5.84017 1.7184 6.35217C1.2524 6.33617 0.8164 6.21017 0.4364 6.00017V6.03617C0.4364 7.38017 1.4004 8.49217 2.6604 8.74617C2.4284 8.80617 2.1844 8.84017 1.9324 8.84017C1.7524 8.84017 1.5744 8.82017 1.4044 8.78617C1.7584 9.88617 2.7864 10.7062 4.0164 10.7302C3.0624 11.5082 1.8444 11.9742 0.5164 11.9742C0.2884 11.9742 0.0644 11.9602 -0.1576 11.9302C1.0924 12.7502 2.5124 13.2282 4.0444 13.2282C9.1524 13.2282 11.9434 8.88617 11.9434 5.11217C11.9434 4.99217 11.9404 4.87217 11.9344 4.75417C12.4804 4.35617 12.9534 3.85417 13.3174 3.35817Z"></path>
                        </svg>
                        <span>@${userData.twitter_username}</span>
                    </div>
                `;
            }

            if (userData.created_at) {
                const joinDate = new Date(userData.created_at).toLocaleDateString('en-US', { year: 'numeric', month: 'long' });
                infoHTML += `
                    <div class="info-item">
                        <svg class="info-icon" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm7-3.25v2.992l2.028.812a.75.75 0 0 1-.557 1.392l-2.5-1A.751.751 0 0 1 7 8.25v-3.5a.75.75 0 0 1 1.5 0Z"></path>
                        </svg>
                        <span>Joined ${joinDate}</span>
                    </div>
                `;
            }

            infoSection.innerHTML = infoHTML;

            document.getElementById('githubLink').href = userData.html_url;

            displayRepositories(reposData);
        }

        function displayRepositories(repos) {
            const reposList = document.getElementById('reposList');
            
            if (!repos || repos.length === 0) {
                reposList.innerHTML = '<div class="no-data">No public repositories found</div>';
                return;
            }

            reposList.innerHTML = repos.map(repo => `
                <div class="repo-card">
                    <a href="${repo.html_url}" class="repo-name" target="_blank">
                        ${repo.name}
                    </a>
                    <div class="repo-description">
                        ${repo.description || 'No description available'}
                    </div>
                    <div class="repo-stats">
                        ${repo.language ? `
                            <span class="repo-language">
                                <span class="language-dot" style="background: ${getLanguageColor(repo.language)}"></span>
                                ${repo.language}
                            </span>
                        ` : ''}
                        <span>‚≠ê ${repo.stargazers_count}</span>
                        <span>üî± ${repo.forks_count}</span>
                        ${repo.license ? `<span>üìÑ ${repo.license.name}</span>` : ''}
                    </div>
                </div>
            `).join('');
        }

        function getLanguageColor(language) {
            const colors = {
                'JavaScript': '#f1e05a',
                'TypeScript': '#3178c6',
                'Python': '#3572A5',
                'Java': '#b07219',
                'C++': '#f34b7d',
                'C': '#555555',
                'C#': '#178600',
                'PHP': '#4F5D95',
                'Ruby': '#701516',
                'Go': '#00ADD8',
                'Rust': '#dea584',
                'Swift': '#ffac45',
                'Kotlin': '#A97BFF',
                'HTML': '#e34c26',
                'CSS': '#563d7c',
                'Shell': '#89e051',
                'Dart': '#00B4AB'
            };
            return colors[language] || '#0969da';
        }
    </script>
</body>
</html>